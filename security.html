<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <title>VisionBank Security Administration</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link rel="stylesheet" href="security.css" />
</head>
<body class="sec-body">

    <!-- HEADER -->
    <header class="sec-header">
        <div class="sec-header-inner">
            <div class="sec-header-left">
                <img src="assets/VisionBank-Logo.png" alt="VisionBank" class="sec-logo">
            </div>
            <div class="sec-header-center">
                <h1>VisionBank Security Administration</h1>
                <p>Access Control • Monitoring • Business Hours</p>
            </div>
        </div>
    </header>

    <!-- MAIN CONTENT -->
    <main class="sec-main">

        <!-- LOGIN VIEW -->
        <section id="login-view" class="glass-card login-card">
            <h2>Administrator Sign In</h2>
            <form id="login-form" autocomplete="off">
                <div class="field">
                    <label for="admin-id">Admin ID</label>
                    <input id="admin-id" name="admin-id" type="text"
                           placeholder="e.g. superadmin" required>
                </div>

                <div class="field">
                    <label for="admin-pin">PIN</label>
                    <input id="admin-pin" name="admin-pin" type="password"
                           inputmode="numeric" minlength="4" maxlength="12"
                           placeholder="Enter your PIN" required>
                </div>

                <div id="login-lock-msg" class="sec-error small hidden"></div>

                <button type="submit" class="btn primary">Sign In</button>

                <p class="help-text">
                    Default Super Admin ID: <strong>superadmin</strong> •
                    Default PIN: <strong>ChangeMeNow!</strong> (please change after first login)
                </p>
            </form>

            <!-- MFA STEP -->
            <div id="mfa-section" class="mfa-card hidden">
                <h3>Multi-Factor Verification</h3>
                <p>
                    A 6-digit code has been sent to the configured
                    <strong>email</strong> and <strong>Teams channel</strong>.
                    Enter it below to complete sign-in.
                </p>
                <form id="mfa-form" autocomplete="off">
                    <div class="field">
                        <label for="mfa-code">Verification code</label>
                        <input id="mfa-code" name="mfa-code" type="text"
                               inputmode="numeric" minlength="6" maxlength="6"
                               placeholder="000000" required>
                    </div>
                    <div id="mfa-error" class="sec-error small hidden"></div>
                    <button type="submit" class="btn primary">Verify &amp; Continue</button>
                    <button type="button" id="mfa-cancel" class="btn ghost">Cancel</button>
                </form>
            </div>

        </section>

        <!-- ADMIN DASHBOARD VIEW -->
        <section id="admin-view" class="hidden">

            <div class="admin-top-bar glass-card">
                <div>
                    <h2 id="admin-welcome">Welcome, Admin</h2>
                    <p id="admin-role" class="muted"></p>
                </div>
                <div class="admin-top-actions">
                    <button id="btn-export" class="btn ghost small">Export settings</button>
                    <button id="btn-logout" class="btn danger small">Log out</button>
                </div>
            </div>

            <!-- 3-column grid -->
            <div class="admin-grid">

                <!-- ACCESS CONTROL -->
                <section class="glass-card">
                    <h3>Allowed IP Addresses</h3>
                    <p class="muted small">
                        These IPs / ranges are allowed to access the VisionBank dashboard.
                    </p>

                    <form id="ip-form" class="inline-form">
                        <input id="ip-input" type="text"
                               placeholder="e.g. 10.100.100.0/24 or 45.19.161.17" required>
                        <button type="submit" class="btn primary small">Add IP</button>
                    </form>

                    <table class="sec-table">
                        <thead>
                        <tr>
                            <th>IP / CIDR</th>
                            <th>Added</th>
                            <th></th>
                        </tr>
                        </thead>
                        <tbody id="ip-tbody"></tbody>
                    </table>
                </section>

                <!-- BUSINESS HOURS -->
                <section class="glass-card">
                    <h3>Business Hours</h3>
                    <p class="muted small">
                        Access is only allowed during these hours (Central Time).
                    </p>

                    <form id="hours-form" class="hours-form">
                        <div class="field-row">
                            <div class="field">
                                <label for="start-time">Open</label>
                                <input id="start-time" type="time" required>
                            </div>
                            <div class="field">
                                <label for="end-time">Close</label>
                                <input id="end-time" type="time" required>
                            </div>
                        </div>

                        <fieldset class="days-fieldset">
                            <legend>Operating days</legend>
                            <label><input type="checkbox" value="1"> Mon</label>
                            <label><input type="checkbox" value="2"> Tue</label>
                            <label><input type="checkbox" value="3"> Wed</label>
                            <label><input type="checkbox" value="4"> Thu</label>
                            <label><input type="checkbox" value="5"> Fri</label>
                            <label><input type="checkbox" value="6"> Sat</label>
                            <label><input type="checkbox" value="0"> Sun</label>
                        </fieldset>

                        <button type="submit" class="btn primary small">Save hours</button>
                        <p id="hours-status" class="muted small"></p>
                    </form>
                </section>

                <!-- AUDIT LOG -->
                <section class="glass-card">
                    <h3>Audit Log</h3>
                    <p class="muted small">
                        Last 50 security events (access attempts, overrides, configuration changes).
                    </p>
                    <div class="log-container">
                        <ul id="log-list" class="log-list"></ul>
                    </div>
                    <button id="btn-clear-log" class="btn ghost small">Clear log</button>
                </section>

            </div>

        </section>

    </main>

    <!-- FOOTER -->
    <footer class="sec-footer glass-footer">
        <div class="footer-left">
            <img src="assets/US-Signal-Logo.png" alt="US Signal" class="sec-footer-logo">
            <span>Created and maintained by <strong>Ahmed Adeyemi, US Signal</strong></span>
        </div>
    </footer>

    <script src="security-dashboard.js" defer></script>
</body>
</html>
