<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <title>Security Admin Console | VisionBankÂ®</title>
    <link rel="stylesheet" href="security.css" />
</head>

<body class="theme-light">

<!-- ====================================== -->
<!-- HEADER -->
<!-- ====================================== -->
<header class="vb-header">
    <div class="vb-header-inner">
        <img src="assets/VisionBank-Logo.png" class="vb-logo">
        <div class="vb-title-block">
            <div class="vb-app-name">Security Admin Console</div>
            <div class="vb-app-subtitle">VisionBankÂ®</div>
        </div>
    </div>

    <button id="themeToggle" class="theme-toggle">
        <span id="themeToggleIcon">ðŸŒ™</span>
        <span id="themeToggleText">Dark mode</span>
    </button>
</header>

<main class="vb-main">

<!-- ====================================== -->
<!-- LOGIN VIEW -->
<!-- ====================================== -->
<section id="login-view" class="card">
    <h2>Secure Administrator Login</h2>

    <form id="login-form" class="form-grid">
        <label>Username <input id="login-username"></label>
        <label>Password <input id="login-pin" type="password"></label>

        <!-- MFA PROMPT (REQUIRED) -->
        <label id="login-totp-wrapper" class="hidden">
            Microsoft Authenticator Code
            <input id="login-totp" maxlength="6">
        </label>

        <button class="btn-primary">Login</button>
    </form>

    <div id="login-message" class="message"></div>
</section>

<!-- ====================================== -->
<!-- MFA SETUP VIEW (NOT COLLAPSIBLE) -->
<!-- ====================================== -->
<section id="mfa-setup-view" class="card hidden">
    <h2>Microsoft Authenticator Setup</h2>

    <div class="mfa-layout">
        <div class="mfa-qr-wrapper">
            <img id="mfa-qr-img" class="mfa-qr-img">
        </div>

        <div class="mfa-details">
            <label>Account <input id="mfa-account" readonly></label>
            <label>Secret <input id="mfa-secret" readonly></label>
            <label>Code <input id="mfa-code"></label>

            <button id="mfa-confirm-btn" class="btn-primary">Confirm</button>
            <button id="mfa-cancel-btn" class="btn-link">Cancel</button>
            <div id="mfa-message" class="message"></div>
        </div>
    </div>
</section>

<!-- ====================================== -->
<!-- ADMIN VIEW -->
<!-- ====================================== -->
<section id="admin-view" class="card hidden">

<div class="admin-header">
    <h2>VisionBankÂ® Security Administration</h2>
    <button id="logout-btn" class="btn-secondary small">Logout</button>
</div>

<!-- ================= BUSINESS HOURS ================= -->
<section id="admin-hours-section" class="admin-section collapsed">
    <div class="section-toggle">
        <svg viewBox="0 0 24 24"><path d="M8 5l8 7-8 7"/></svg>
        <h3>Business Hours</h3>
    </div>
    <div class="section-content">
        <form id="hours-form" class="form-grid hours-grid">
            <input type="time" id="hours-start">
            <input type="time" id="hours-end">
            <fieldset class="days-fieldset">
                <label><input type="checkbox" class="hours-day" value="1">Mon</label>
                <label><input type="checkbox" class="hours-day" value="2">Tue</label>
                <label><input type="checkbox" class="hours-day" value="3">Wed</label>
                <label><input type="checkbox" class="hours-day" value="4">Thu</label>
                <label><input type="checkbox" class="hours-day" value="5">Fri</label>
                <label><input type="checkbox" class="hours-day" value="6">Sat</label>
                <label><input type="checkbox" class="hours-day" value="0">Sun</label>
            </fieldset>
            <button class="btn-primary">Save</button>
        </form>
    </div>
</section>

<!-- ================= IP ALLOWLIST ================= -->
<section id="ip-manager" class="admin-section collapsed">
    <div class="section-toggle">
        <svg viewBox="0 0 24 24"><path d="M8 5l8 7-8 7"/></svg>
        <h3>Allowed IPs / Subnets</h3>
    </div>
    <div class="section-content">
        <div id="ip-list" class="skeleton skeleton-block"></div>
        <div class="ip-add-row">
            <input id="ip-add-input">
            <button id="ip-add-btn" class="btn-primary">Add</button>
        </div>
        <button id="ip-save-btn" class="btn-secondary">Save</button>
    </div>
</section>

<!-- ================= CIDR TESTERS ================= -->
<section id="cidr-ip-tester" class="admin-section collapsed">
    <div class="section-toggle">
        <svg viewBox="0 0 24 24"><path d="M8 5l8 7-8 7"/></svg>
        <h3>CIDR / IP Tester</h3>
    </div>
    <div class="section-content">
        <input id="ip-test-input">
        <textarea id="ip-rules-textarea"></textarea>
        <button id="run-ip-test-btn" class="btn-primary">Test</button>
        <div id="ip-test-result" class="cidr-result-box"></div>
    </div>
</section>

<!-- âœ… USER MANAGEMENT INSERTION POINT â€” DO NOT TOUCH -->
<!-- security.js inserts User Management HERE -->

<!-- ================= AUDIT LOG ================= -->
<section id="admin-audit-section" class="admin-section collapsed">
    <div class="section-toggle">
        <svg viewBox="0 0 24 24"><path d="M8 5l8 7-8 7"/></svg>
        <h3>Security Audit Log</h3>
    </div>
    <div class="section-content">
        <pre id="audit-log" class="audit-log skeleton skeleton-block"></pre>
    </div>
</section>

</section>
</main>

<!-- ====================================== -->
<!-- FOOTER (RESTORED) -->
<!-- ====================================== -->
<footer class="vb-footer">
    <div class="vb-footer-inner">
        <img src="assets/US-Signal-Logo.png" class="footer-logo">
        <span>Created and maintained by <strong>Ahmed Adeyemi</strong>, Â©2025 US Signal</span>
    </div>
</footer>

<script src="security.js"></script>

<script>
document.addEventListener("click", e => {
    const t = e.target.closest(".section-toggle");
    if (t) t.closest(".admin-section").classList.toggle("collapsed");
});
</script>

</body>
</html>
