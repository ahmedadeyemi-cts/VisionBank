<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <title>Security Admin Console | VisionBankÂ®</title>
    <link rel="stylesheet" href="security.css" />
</head>

<body class="theme-light">

<header class="vb-header">
    <div class="vb-header-inner">
        <img src="assets/VisionBank-Logo.png" alt="VisionBank" class="vb-logo">
        <div class="vb-title-block">
            <div class="vb-app-name">Security Admin Console</div>
            <div class="vb-app-subtitle">VisionBankÂ®</div>
        </div>
    </div>

    <div class="vb-header-actions">
        <button id="themeToggle" class="theme-toggle">
            <span id="themeToggleIcon">ðŸŒ™</span>
            <span id="themeToggleText">Dark mode</span>
        </button>
    </div>
</header>

<main class="vb-main">

<!-- LOGIN VIEW -->
<section id="login-view" class="card">
    <h2>Secure Administrator Login</h2>
    <p class="card-subtitle">
        Sign in with your Username, Password, and Microsoft Authenticator.
    </p>

    <form id="login-form" class="form-grid">
        <label>Username <input id="login-username"></label>
        <label>Password <input id="login-pin" type="password"></label>

        <label id="login-totp-wrapper" class="hidden">
            Microsoft Authenticator Code
            <input id="login-totp">
        </label>

        <button class="btn-primary">Login</button>
    </form>

    <div id="login-message" class="message"></div>
</section>

<!-- MFA VIEW -->
<section id="mfa-setup-view" class="card hidden">
    <h2>Microsoft Authenticator Setup</h2>
    <div class="mfa-layout">
        <img id="mfa-qr-img">
        <input id="mfa-account" readonly>
        <input id="mfa-secret" readonly>
        <input id="mfa-code">
        <button id="mfa-confirm-btn" class="btn-primary">Confirm</button>
        <button id="mfa-cancel-btn" class="btn-link">Cancel</button>
        <div id="mfa-message"></div>
    </div>
</section>

<!-- ADMIN VIEW -->
<section id="admin-view" class="card hidden">

<div class="admin-header">
    <div>
        <h2>VisionBankÂ® Security Administration</h2>
        <p class="card-subtitle">
            Access Control â€¢ User Management â€¢ Logs â€¢ Business Rules
        </p>
    </div>

    <div class="admin-controls">
        <button id="expand-all-btn" class="btn-secondary small">Expand All</button>
        <button id="collapse-all-btn" class="btn-secondary small">Collapse All</button>
        <button id="logout-btn" class="btn-secondary small">Logout</button>
    </div>
</div>

<!-- BUSINESS HOURS -->
<section id="admin-hours-section" class="admin-section">
    <div class="collapsible-header">
        <h3>Business Hours</h3>
        <button class="collapse-toggle"><span>â–¾</span> Collapse</button>
    </div>
    <div class="collapsible-content">
        <form id="hours-form" class="form-grid hours-grid">
            <input id="hours-start" type="time">
            <input id="hours-end" type="time">
            <button class="btn-primary">Save Business Hours</button>
        </form>
    </div>
</section>

<!-- IP ALLOWLIST -->
<section id="ip-manager" class="admin-section">
    <div class="collapsible-header">
        <h3>Allowed IPs / Subnets</h3>
        <button class="collapse-toggle"><span>â–¾</span> Collapse</button>
    </div>

    <div class="collapsible-content">
        <div id="ip-list"></div>
        <input id="ip-add-input">
        <button id="ip-add-btn" class="btn-primary">Add Rule</button>
        <button id="ip-save-btn" class="btn-secondary">Save IP Rules</button>
    </div>
</section>

<!-- âœ… CIDR / IP TESTER (RESTORED) -->
<section id="cidr-ip-tester" class="admin-section collapsed">
    <div class="collapsible-header">
        <h3>CIDR / IP Tester</h3>
        <button class="collapse-toggle">
            <span>â–¸</span> Expand
        </button>
    </div>

    <div class="collapsible-content">
        <input id="ip-test-input" placeholder="IPv4 or IPv6">
        <textarea id="ip-rules-textarea"></textarea>
        <button id="run-ip-test-btn" class="btn-primary">Run CIDR Test</button>
        <div id="ip-test-result"></div>
    </div>
</section>

<!-- âœ… CIDR RANGE TESTER (RESTORED) -->
<section id="cidr-range-tester" class="admin-section collapsed">
    <div class="collapsible-header">
        <h3>CIDR Tester</h3>
        <button class="collapse-toggle">
            <span>â–¸</span> Expand
        </button>
    </div>

    <div class="collapsible-content">
        <input id="cidr-input-a">
        <input id="cidr-input-b">
        <button id="cidr-test-btn" class="btn-primary">Run CIDR Test</button>
        <div id="cidr-test-result"></div>
    </div>
</section>

<!-- USER MANAGEMENT INSERTED BY JS -->

<!-- AUDIT LOG -->
<section id="admin-audit-section" class="admin-section collapsed">
    <div class="collapsible-header">
        <h3>Security Audit Log</h3>
        <button class="collapse-toggle"><span>â–¸</span> Expand</button>
    </div>

    <div class="collapsible-content">
        <pre id="audit-log"></pre>
    </div>
</section>

</section>
</main>

<footer class="vb-footer">
    <span>Created by <strong>Ahmed Adeyemi</strong>, Â©2025 US Signal</span>
</footer>

<script src="security.js"></script>
</body>
</html>
