<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <title>Security Admin Console | VisionBankÂ®</title>
    <link rel="stylesheet" href="security.css" />
</head>

<body class="theme-light">

<!-- ====================================== -->
<!-- HEADER                                 -->
<!-- ====================================== -->
<header class="vb-header">
    <div class="vb-header-inner">
        <img src="assets/VisionBank-Logo.png" alt="VisionBank" class="vb-logo">

        <div class="vb-title-block">
            <div class="vb-app-name">Security Admin Console</div>
            <div class="vb-app-subtitle">VisionBankÂ®</div>
        </div>
    </div>

    <div class="vb-header-actions">
        <button id="themeToggle" class="theme-toggle" aria-label="Toggle theme">
            <span id="themeToggleIcon">ðŸŒ™</span>
            <span id="themeToggleText">Dark mode</span>
        </button>
    </div>
</header>

<main class="vb-main">

    <!-- ====================================== -->
    <!-- LOGIN VIEW                             -->
    <!-- ====================================== -->
    <section id="login-view" class="card">
        <h2>Secure Administrator Login</h2>
        <p class="card-subtitle">
            Sign in with your Username, Password, and when required a Microsoft Authenticator code.
        </p>

        <form id="login-form" class="form-grid">
            <label>Username
                <input type="text" id="login-username" autocomplete="username">
            </label>

            <label>Password
                <input type="password" id="login-pin" autocomplete="current-password">
            </label>

            <label id="login-totp-wrapper" class="hidden">
                Microsoft Authenticator Code
                <input type="text" id="login-totp" maxlength="6" inputmode="numeric">
            </label>

            <button type="submit" class="btn-primary">Login</button>
        </form>

        <div id="login-message" class="message"></div>
    </section>

    <!-- ====================================== -->
    <!-- MFA SETUP VIEW                         -->
    <!-- ====================================== -->
    <section id="mfa-setup-view" class="card hidden">
        <h2>Microsoft Authenticator Setup</h2>

        <div class="mfa-layout">
            <div class="mfa-qr-wrapper">
                <img id="mfa-qr-img" class="mfa-qr-img" alt="MFA QR Code" />
                <p class="mfa-qr-caption">Scan with Microsoft Authenticator</p>
            </div>

            <div class="mfa-details">
                <label>Account
                    <input type="text" id="mfa-account" readonly>
                </label>

                <label>Secret Key
                    <input type="text" id="mfa-secret" readonly>
                </label>

                <label>Enter 6-digit code
                    <input type="text" id="mfa-code" maxlength="6">
                </label>

                <button id="mfa-confirm-btn" class="btn-primary">Confirm & Enable MFA</button>
                <button id="mfa-cancel-btn" class="btn-link">Cancel</button>

                <div id="mfa-message" class="message"></div>
            </div>
        </div>
    </section>

    <!-- ====================================== -->
    <!-- ADMIN VIEW                             -->
    <!-- ====================================== -->
    <section id="admin-view" class="card hidden">

        <div class="admin-header">
            <div>
                <h2>VisionBankÂ® Security Administration</h2>
                <p class="card-subtitle">Access Control â€¢ Users â€¢ Logs â€¢ Rules</p>
            </div>
            <button id="logout-btn" class="btn-secondary small">Logout</button>
        </div>

        <!-- ===================================================== -->
        <!-- BUSINESS HOURS                                       -->
        <!-- ===================================================== -->
        <section id="admin-hours-section" class="admin-section" data-collapsed="false">

            <div class="section-header">
                <div class="section-header-left">
                    <span class="svg-icon">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <circle cx="12" cy="12" r="10"/>
                            <path d="M12 6v6l4 2"/>
                        </svg>
                    </span>
                    <h3>Business Hours</h3>
                </div>

                <span class="section-toggle svg-icon">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <polyline points="6 9 12 15 18 9"/>
                    </svg>
                </span>
            </div>

            <div class="section-body">
                <p class="section-help">Access enforced by CST/CDT hours.</p>

                <form id="hours-form" class="form-grid hours-grid">
                    <label>Start
                        <input type="time" id="hours-start">
                    </label>

                    <label>End
                        <input type="time" id="hours-end">
                    </label>

                    <fieldset class="days-fieldset">
                        <legend>Active Days</legend>
                        <label><input type="checkbox" value="1" class="hours-day"> Mon</label>
                        <label><input type="checkbox" value="2" class="hours-day"> Tue</label>
                        <label><input type="checkbox" value="3" class="hours-day"> Wed</label>
                        <label><input type="checkbox" value="4" class="hours-day"> Thu</label>
                        <label><input type="checkbox" value="5" class="hours-day"> Fri</label>
                        <label><input type="checkbox" value="6" class="hours-day"> Sat</label>
                        <label><input type="checkbox" value="0" class="hours-day"> Sun</label>
                    </fieldset>

                    <button type="submit" class="btn-primary">Save Business Hours</button>
                </form>
            </div>
        </section>

        <!-- ===================================================== -->
        <!-- IP ALLOWLIST                                         -->
        <!-- ===================================================== -->
        <section id="ip-manager" class="admin-section" data-collapsed="false">

            <div class="section-header">
                <div class="section-header-left">
                    <span class="svg-icon">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <rect x="3" y="4" width="18" height="16"/>
                            <path d="M7 8h10M7 12h10M7 16h10"/>
                        </svg>
                    </span>
                    <h3>Allowed IPs / Subnets</h3>
                </div>

                <span class="section-toggle svg-icon">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <polyline points="6 9 12 15 18 9"/>
                    </svg>
                </span>
            </div>

            <div class="section-body">
                <p class="section-help">Allowed access ranges.</p>

                <div id="ip-list" class="ip-list"></div>

                <!-- Skeleton -->
                <div class="ip-skeleton">
                    <div class="skeleton skeleton-block"></div>
                    <div class="skeleton skeleton-block"></div>
                </div>

                <div class="ip-add-row">
                    <input id="ip-add-input" type="text" class="input" placeholder="IPv4 / IPv6 / CIDR">
                    <button id="ip-add-btn" class="btn-primary">Add Rule</button>
                </div>

                <button id="ip-save-btn" class="btn-secondary" style="margin-top:12px;">
                    Save IP Rules
                </button>
            </div>
        </section>

        <!-- ===================================================== -->
        <!-- USER MANAGEMENT INSERTED BY JS                        -->
        <!-- ===================================================== -->

        <!-- ===================================================== -->
        <!-- AUDIT LOG                                            -->
        <!-- ===================================================== -->
        <section id="admin-audit-section" class="admin-section" data-collapsed="false">

            <div class="section-header">
                <div class="section-header-left">
                    <span class="svg-icon">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M4 4h16v16H4z"/>
                            <path d="M8 8h8M8 12h8M8 16h8"/>
                        </svg>
                    </span>
                    <h3>Security Audit Log</h3>
                </div>

                <span class="section-toggle svg-icon">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <polyline points="6 9 12 15 18 9"/>
                    </svg>
                </span>
            </div>

            <div class="section-body">
                <pre id="audit-log" class="audit-log"></pre>

                <!-- Skeleton -->
                <div class="audit-skeleton">
                    <div class="skeleton skeleton-text"></div>
                    <div class="skeleton skeleton-text"></div>
                    <div class="skeleton skeleton-text"></div>
                </div>
            </div>
        </section>

    </section>
</main>

<!-- ====================================== -->
<!-- FOOTER                                 -->
<!-- ====================================== -->
<footer class="vb-footer">
    <div class="vb-footer-inner">
        <img src="assets/US-Signal-Logo.png" alt="US Signal" class="footer-logo">
        <span>Created and maintained by <strong>Ahmed Adeyemi</strong>, Â©2025</span>
    </div>
</footer>

<!-- MAIN JS -->
<script src="security.js"></script>

<!-- SECTION TOGGLE SCRIPT (SAFE) -->
<script>
document.querySelectorAll(".section-header").forEach(header => {
    header.addEventListener("click", () => {
        const section = header.closest(".admin-section");
        const collapsed = section.getAttribute("data-collapsed") === "true";
        section.setAttribute("data-collapsed", String(!collapsed));
    });
});
</script>

</body>
</html>
